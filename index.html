<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>New Haven Studio Apartment Comparator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Warm Neutrals -->
    <!-- Application Structure Plan: A single-page dashboard application designed for direct comparison. The structure prioritizes user tasks over mirroring the linear report. It features three main interactive sections: 1) An "Overview & Comparison" dashboard with a dynamic chart and filter controls to visually compare properties by key metrics (value, quiet, management). 2) A "Deep Dive Profiles" section with detailed cards for each property, accessible via smooth-scrolling from the overview. 3) A "Comparative Insights" section presenting detailed textual analysis and tables. 4) A "Key Takeaways" section summarizing the report's recommendations. This comprehensive structure was chosen because the primary user goal is to weigh trade-offs between properties, which is best facilitated by interactive, side-by-side visualization and detailed textual support rather than linear reading. -->
    <!-- Visualization & Content Choices:
        - Price/Value Comparison: Goal: Compare affordability. Method: Interactive Bar Chart (Chart.js) showing the lowest studio price. Interaction: The chart updates when the user selects a priority from a dropdown filter. Justification: A bar chart provides the clearest visual representation of relative costs. The filter makes the comparison task-oriented.
        - Resident Experience (Noise/Management): Goal: Quantify and compare qualitative feedback. Method: A 1-5 scoring system derived from the report's text is created and used to power the bar chart. Interaction: The chart dynamically displays these scores when the user filters by "Quietest" or "Best Management". Justification: Quantifying subjective data is essential for direct comparison in a chart format.
        - Amenities: Goal: Inform and compare features. Method: An amenity score (count of key features) for the main chart and Unicode icons (e.g., üèä, üí™) within the detail cards. Justification: The score allows for high-level comparison, while icons provide quick, scannable, and visually appealing details.
        - Textual Content: Goal: Provide deep context on demand. Method: Organized into structured "Deep Dive" cards with clear headings and bullet points for pros/cons, and new sections for "Overview", "Floor Plans/Pricing", and "Overall Living". The "Comparative Insights" section uses collapsible details for in-depth analysis. Justification: This keeps the main dashboard uncluttered while making comprehensive information easily accessible via scrolling and interactive expansion.
        - Tables: Goal: Provide structured data comparison. Method: HTML tables for "Studio Apartment Comparison" and "Resident Experience Snapshot". Justification: Tables are the most effective way to present structured, comparative data clearly.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --accent-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --neutral-gradient: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            --text-primary: #2d3748;
            --text-secondary: #4a5568;
            --surface-primary: #ffffff;
            --surface-secondary: #f7fafc;
            --border-light: #e2e8f0;
            --shadow-soft: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-medium: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-large: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            color: var(--text-primary);
        }
        
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            height: 350px;
            background: var(--surface-primary);
            border-radius: 1rem;
            padding: 1.5rem;
            box-shadow: var(--shadow-medium);
        }
        
        @media (min-width: 768px) {
            .chart-container {
                height: 450px;
            }
        }
        
        .nav-link {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        .nav-link::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 3px;
            background: var(--primary-gradient);
            transition: width 0.3s ease;
        }
        
        .nav-link:hover::before,
        .nav-link.active::before {
            width: 100%;
        }
        
        .nav-link.active {
            color: #667eea;
            font-weight: 600;
        }
        
        .card-modern {
            background: var(--surface-primary);
            border-radius: 1.5rem;
            box-shadow: var(--shadow-soft);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: hidden;
            position: relative;
        }
        
        .card-modern::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--primary-gradient);
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .card-modern:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-large);
        }
        
        .card-modern:hover::before {
            opacity: 1;
        }
        
        .gradient-text {
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 700;
        }
        
        .btn-modern {
            background: var(--primary-gradient);
            color: white;
            border: none;
            border-radius: 0.75rem;
            padding: 0.75rem 1.5rem;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: var(--shadow-soft);
        }
        
        .btn-modern:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-medium);
        }
        
        .feature-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--accent-gradient);
            color: white;
            font-size: 1.25rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
        }
        
        .feature-icon:hover {
            transform: scale(1.1) rotate(5deg);
        }
        
        .animate-fade-in {
            animation: fadeIn 0.6s ease-out;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .animate-slide-up {
            animation: slideUp 0.8s ease-out;
        }
        
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(40px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        details > summary {
            list-style: none;
            cursor: pointer;
            padding: 1rem;
            background: var(--surface-secondary);
            border-radius: 0.75rem;
            margin-bottom: 0.5rem;
            transition: all 0.3s ease;
        }
        
        details > summary:hover {
            background: var(--surface-primary);
            box-shadow: var(--shadow-soft);
        }
        
        details > summary::-webkit-details-marker {
            display: none;
        }
        
        details > summary::after {
            content: '+';
            float: right;
            font-size: 1.5rem;
            color: #667eea;
            transition: transform 0.3s ease;
        }
        
        details[open] > summary::after {
            content: '‚àí';
            transform: rotate(180deg);
        }
        
        .property-card {
            background: var(--surface-primary);
            border-radius: 1.5rem;
            overflow: hidden;
            box-shadow: var(--shadow-soft);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }
        
        .property-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: var(--primary-gradient);
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .property-card:hover {
            transform: translateY(-6px);
            box-shadow: var(--shadow-large);
        }
        
        .property-card:hover::before {
            opacity: 1;
        }
        
        .sticky-nav {
            backdrop-filter: blur(20px);
            background: rgba(255, 255, 255, 0.9);
            border-bottom: 1px solid var(--border-light);
            transition: all 0.3s ease;
        }
        
        .hero-section {
            background: var(--primary-gradient);
            color: white;
            padding: 4rem 2rem;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .hero-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 200"><defs><linearGradient id="a" x1="0%" y1="0%" x2="100%" y2="0%"><stop offset="0%" style="stop-color:rgba(255,255,255,0.1)"/><stop offset="100%" style="stop-color:rgba(255,255,255,0.05)"/></linearGradient></defs><path d="M0,100 Q250,50 500,100 T1000,100 L1000,0 L0,0 Z" fill="url(%23a)"/></svg>') no-repeat;
            background-size: cover;
            opacity: 0.1;
        }
        
        .scroll-indicator {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--primary-gradient);
            transform-origin: 0%;
            transform: scaleX(0);
            z-index: 9999;
            transition: transform 0.1s ease;
        }
        
        .table-modern {
            background: var(--surface-primary);
            border-radius: 1rem;
            overflow: hidden;
            box-shadow: var(--shadow-soft);
        }
        
        .table-modern thead {
            background: var(--primary-gradient);
            color: white;
        }
        
        .table-modern tbody tr {
            transition: all 0.2s ease;
        }
        
        .table-modern tbody tr:hover {
            background: var(--surface-secondary);
            transform: scale(1.01);
        }
        
        .loading-skeleton {
            background: linear-gradient(90deg, #f0f0f0 25%, transparent 37%, transparent 63%, #f0f0f0 75%);
            background-size: 400% 100%;
            animation: skeleton-loading 1.4s ease infinite;
        }
        
        @keyframes skeleton-loading {
            0% {
                background-position: 100% 50%;
            }
            100% {
                background-position: -100% 50%;
            }
        }
        
        /* Enhanced Accessibility */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        
        .focus-visible {
            outline: 2px solid #667eea;
            outline-offset: 2px;
        }
        
        /* Advanced Scroll Animations */
        .scroll-reveal {
            opacity: 0;
            transform: translateY(40px);
            transition: all 0.8s cubic-bezier(0.165, 0.84, 0.44, 1);
        }
        
        .scroll-reveal.is-visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        .scroll-reveal-left {
            opacity: 0;
            transform: translateX(-40px);
            transition: all 0.8s cubic-bezier(0.165, 0.84, 0.44, 1);
        }
        
        .scroll-reveal-left.is-visible {
            opacity: 1;
            transform: translateX(0);
        }
        
        .scroll-reveal-right {
            opacity: 0;
            transform: translateX(40px);
            transition: all 0.8s cubic-bezier(0.165, 0.84, 0.44, 1);
        }
        
        .scroll-reveal-right.is-visible {
            opacity: 1;
            transform: translateX(0);
        }
        
        /* Enhanced Mobile Touch */
        @media (hover: none) and (pointer: coarse) {
            .btn-modern:hover {
                transform: none;
                box-shadow: var(--shadow-soft);
            }
            
            .btn-modern:active {
                transform: scale(0.95);
                transition: transform 0.1s ease;
            }
            
            .card-modern:hover {
                transform: none;
                box-shadow: var(--shadow-soft);
            }
            
            .card-modern:active {
                transform: scale(0.98);
                transition: transform 0.1s ease;
            }
        }
        
        /* Improved Loading States */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .loading-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f0f0f0;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Enhanced Performance */
        .will-change-transform {
            will-change: transform;
        }
        
        .will-change-opacity {
            will-change: opacity;
        }
        
        /* Reduced Motion Support */
        @media (prefers-reduced-motion: reduce) {
            .animate-fade-in,
            .animate-slide-up,
            .scroll-reveal,
            .scroll-reveal-left,
            .scroll-reveal-right {
                animation: none;
                transition: none;
            }
            
            .loading-skeleton {
                animation: none;
            }
        }
    </style>
</head>
<body class="text-gray-800 antialiased">
    <div class="loading-overlay">
        <div class="loading-spinner"></div>
        <span class="sr-only">Loading content...</span>
    </div>
    
    <div class="scroll-indicator"></div>
    
    <div id="app" class="min-h-screen">
        <header class="hero-section animate-fade-in">
            <div class="container mx-auto px-4 relative z-10">
                <h1 class="text-4xl md:text-6xl font-bold mb-4 leading-tight">
                    Downtown New Haven <span class="block text-3xl md:text-5xl">Studio Finder</span>
                </h1>
                <p class="text-xl md:text-2xl opacity-90 mb-8 max-w-2xl mx-auto">
                    Your interactive guide to luxury apartments with pools around $2200
                </p>
                <button class="btn-modern text-lg px-8 py-3" onclick="document.getElementById('comparison-section').scrollIntoView({behavior: 'smooth'})">
                    Explore Properties
                </button>
            </div>
        </header>

        <nav class="sticky-nav sticky top-0 z-50 py-4 border-b border-gray-200" role="navigation" aria-label="Main navigation">
            <div class="container mx-auto px-4">
                <ul class="flex justify-center items-center space-x-8" role="menubar">
                    <li role="none"><a href="#comparison-section" class="nav-link font-semibold text-gray-600 hover:text-purple-600 pb-2" role="menuitem" aria-label="Go to comparison section">Comparison</a></li>
                    <li role="none"><a href="#profiles-section" class="nav-link font-semibold text-gray-600 hover:text-purple-600 pb-2" role="menuitem" aria-label="Go to profiles section">Profiles</a></li>
                    <li role="none"><a href="#comparative-insights-section" class="nav-link font-semibold text-gray-600 hover:text-purple-600 pb-2" role="menuitem" aria-label="Go to insights section">Insights</a></li>
                    <li role="none"><a href="#recommendations-section" class="nav-link font-semibold text-gray-600 hover:text-purple-600 pb-2" role="menuitem" aria-label="Go to recommendations section">Recommendations</a></li>
                </ul>
            </div>
        </nav>

        <main class="container mx-auto px-4 py-8">
            <section id="comparison-section" class="mb-20 scroll-reveal">
                <div class="text-center mb-12">
                    <h2 class="text-4xl font-bold gradient-text mb-4">Property Comparison</h2>
                    <p class="text-xl text-gray-600 max-w-2xl mx-auto">
                        Select a priority to see how the top contenders stack up. Click a property's name on the chart to jump to its detailed profile.
                    </p>
                </div>
                
                <div class="card-modern p-8 mb-8 scroll-reveal-left">
                    <div class="flex flex-col md:flex-row justify-center items-center gap-4 mb-8">
                        <div class="feature-icon will-change-transform">
                            <span>üìä</span>
                        </div>
                        <div class="flex-1 text-center md:text-left">
                            <label for="priority-filter" class="text-lg font-semibold text-gray-700 block mb-2">Prioritize by:</label>
                            <select id="priority-filter" class="bg-white border-2 border-gray-200 text-gray-900 rounded-xl px-4 py-3 focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all" aria-label="Select priority for comparison">
                                <option value="overall" selected>Overall Score</option>
                                <option value="value">Best Value (Price)</option>
                                <option value="quiet">Quietest Environment</option>
                                <option value="management">Best Management</option>
                                <option value="amenities">Most Amenities</option>
                            </select>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="property-chart" aria-label="Property comparison chart"></canvas>
                        <div id="chart-loading" class="loading-skeleton h-96 rounded-lg" style="display: none;"></div>
                    </div>
                </div>
                
                <div class="grid md:grid-cols-3 gap-6 mb-12">
                    <div class="card-modern p-6 text-center scroll-reveal will-change-transform" style="transition-delay: 0.1s;">
                        <div class="feature-icon mx-auto will-change-transform">üí∞</div>
                        <h3 class="text-xl font-semibold mb-2">Best Value</h3>
                        <p class="text-gray-600">Compare pricing and get the most for your money</p>
                    </div>
                    <div class="card-modern p-6 text-center scroll-reveal will-change-transform" style="transition-delay: 0.2s;">
                        <div class="feature-icon mx-auto will-change-transform">üèä</div>
                        <h3 class="text-xl font-semibold mb-2">Premium Amenities</h3>
                        <p class="text-gray-600">Luxury pools, fitness centers, and modern spaces</p>
                    </div>
                    <div class="card-modern p-6 text-center scroll-reveal will-change-transform" style="transition-delay: 0.3s;">
                        <div class="feature-icon mx-auto will-change-transform">üèôÔ∏è</div>
                        <h3 class="text-xl font-semibold mb-2">Prime Location</h3>
                        <p class="text-gray-600">Downtown convenience with walkable access</p>
                    </div>
                </div>
            </section>

            <section id="profiles-section" class="mb-20">
                <div class="text-center mb-12">
                    <h2 class="text-4xl font-bold gradient-text mb-4">Deep Dive Profiles</h2>
                    <p class="text-xl text-gray-600 max-w-2xl mx-auto">
                        Explore detailed information on each property, including amenities, pricing, and comprehensive resident experiences.
                    </p>
                </div>
                <div id="property-profiles-container" class="space-y-12">
                </div>
            </section>

            <section id="comparative-insights-section" class="mb-20">
                <div class="text-center mb-12">
                    <h2 class="text-4xl font-bold gradient-text mb-4">Comparative Insights</h2>
                    <p class="text-xl text-gray-600 max-w-2xl mx-auto">
                        Delve deeper into the nuances of each property, comparing them across key aspects of urban living.
                    </p>
                </div>

                <div class="card-modern p-8 mb-8">
                    <div class="flex items-center mb-6">
                        <div class="feature-icon mr-4">üìã</div>
                        <h3 class="text-2xl font-semibold">Studio Apartment Comparison</h3>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="table-modern min-w-full">
                            <thead>
                                <tr>
                                    <th scope="col" class="px-6 py-4 text-left text-sm font-semibold uppercase tracking-wider">Property Name</th>
                                    <th scope="col" class="px-6 py-4 text-left text-sm font-semibold uppercase tracking-wider">Studio Price Range</th>
                                    <th scope="col" class="px-6 py-4 text-left text-sm font-semibold uppercase tracking-wider">Current Specials</th>
                                    <th scope="col" class="px-6 py-4 text-left text-sm font-semibold uppercase tracking-wider">Pool Type</th>
                                    <th scope="col" class="px-6 py-4 text-left text-sm font-semibold uppercase tracking-wider">Common Spaces</th>
                                    <th scope="col" class="px-6 py-4 text-left text-sm font-semibold uppercase tracking-wider">Outdoor Spaces</th>
                                    <th scope="col" class="px-6 py-4 text-left text-sm font-semibold uppercase tracking-wider">Availability</th>
                                </tr>
                            </thead>
                            <tbody id="comparison-table-body" class="divide-y divide-gray-200">
                                <!-- Table rows will be populated by JS -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="card-modern p-8 mb-8">
                    <div class="flex items-center mb-6">
                        <div class="feature-icon mr-4">‚≠ê</div>
                        <h3 class="text-2xl font-semibold">Resident Experience Snapshot</h3>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="table-modern min-w-full">
                            <thead>
                                <tr>
                                    <th scope="col" class="px-6 py-4 text-left text-sm font-semibold uppercase tracking-wider">Property Name</th>
                                    <th scope="col" class="px-6 py-4 text-left text-sm font-semibold uppercase tracking-wider">Management</th>
                                    <th scope="col" class="px-6 py-4 text-left text-sm font-semibold uppercase tracking-wider">Noise Levels</th>
                                    <th scope="col" class="px-6 py-4 text-left text-sm font-semibold uppercase tracking-wider">Living Experience</th>
                                    <th scope="col" class="px-6 py-4 text-left text-sm font-semibold uppercase tracking-wider">Pet Friendliness</th>
                                </tr>
                            </thead>
                            <tbody id="resident-experience-table-body" class="divide-y divide-gray-200">
                                <!-- Table rows will be populated by JS -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="card-modern p-8">
                    <div class="flex items-center mb-6">
                        <div class="feature-icon mr-4">üí°</div>
                        <h3 class="text-2xl font-semibold">Comparative Insights: Value, Lifestyle, and Trade-offs</h3>
                    </div>

                    <details class="group">
                        <summary class="flex justify-between items-center font-semibold cursor-pointer py-2 text-teal-700">
                            Pricing vs. True Value
                        </summary>
                        <div class="px-4 pb-2 text-gray-700">
                            <p class="text-sm">The advertised "starting at" prices for studio apartments can be misleading without considering current promotional offers. For instance, The Anthem at Square 10 offers studios starting as low as $1,795 and includes "up to two months free" on select units. This can significantly reduce the effective monthly rent over a 12-month lease, potentially making it the most financially attractive option while still providing extensive amenities. In contrast, properties like The Audubon, with studios starting around $2,269-$2,490, and Corsair at $2,337+, might appear to fit the budget less directly. The true value proposition of each property is not solely determined by the base rent but by how well that price aligns with the quality, accessibility, and consistency of the amenities and services provided.</p>
                        </div>
                    </details>

                    <details class="group">
                        <summary class="flex justify-between items-center font-semibold cursor-pointer py-2 text-teal-700">
                            Noise Tolerance: An Inherent Downtown Reality
                        </summary>
                        <div class="px-4 pb-2 text-gray-700">
                            <p class="text-sm">A recurring theme across the downtown New Haven properties is the pervasive issue of noise. This is an inherent characteristic of urban living and a critical factor for prospective residents. Sources of noise include street traffic, sirens, nightlife, and train horns. Properties like 360 State Street and The Whit are frequently cited for significant external noise, with complaints about loud music, motorcycles, and thin walls transmitting sound. The Audubon also faces substantial internal noise issues due to a reported "party central" atmosphere and unenforced noise policies. This suggests that a certain level of urban noise is an unavoidable trade-off for a prime downtown location. While some properties may have better sound insulation or quieter orientations (e.g., higher floors, non-street facing units), renters seeking absolute quiet may find downtown living challenging. The absence of negative noise comments for The Anthem at Square 10 in the provided reviews stands out as a potential differentiator, possibly due to newer construction or its specific location within the Square 10 development.</p>
                        </div>
                    </details>

                    <details class="group">
                        <summary class="flex justify-between items-center font-semibold cursor-pointer py-2 text-teal-700">
                            The Critical Impact of Management Quality
                        </summary>
                        <div class="px-4 pb-2 text-gray-700">
                            <p class="text-sm">The quality and responsiveness of property management significantly influence the overall living experience, often more so than the initial appeal of the building. This includes aspects like maintenance efficiency, communication, and, crucially, the enforcement of community rules. At 360 State Street, a change in management to South Oxford has been directly linked to a "slow degradation in amenities and building upkeep," poor communication regarding critical issues, and a perceived prioritization of profit over resident well-being. Similarly, at The Whit and The Audubon, inconsistent rule enforcement, particularly concerning pet behavior and noise, has led to a diminished quality of life for residents, despite otherwise positive aspects of the property. When management fails to uphold community standards, even well-appointed buildings can suffer from a "glorified dorm" atmosphere or safety concerns, as reported at The Audubon with garage break-ins. Conversely, The Anthem at Square 10 consistently receives praise for its attentive and helpful staff, contributing to a smooth living experience. This underscores that effective management is pivotal in maintaining the "luxury" promise beyond initial impressions.</p>
                        </div>
                    </details>

                    <details class="group">
                        <summary class="flex justify-between items-center font-semibold cursor-pointer py-2 text-teal-700">
                            Community Vibe and Resident Demographics
                        </summary>
                        <div class="px-4 pb-2 text-gray-700">
                            <p class="text-sm">The reported community atmospheres vary significantly. 360 State Street is described as a "nice quiet community" with friendly people and a good mix of social events, catering to young professionals in healthcare or corporate roles. The Whit benefits from a policy that generally excludes undergraduates, contributing to a perceived better atmosphere. In contrast, The Audubon has seen a "shift in clientele" towards a "party central" environment, with many residents describing it as a "glorified dorm" due to loud and inconsiderate neighbors. This highlights how resident demographics and management's role in fostering a community ethos can profoundly shape the living environment. For a discerning professional, a property's community vibe can be as important as its physical amenities.</p>
                        </div>
                    </details>

                    <details class="group">
                        <summary class="flex justify-between items-center font-semibold cursor-pointer py-2 text-teal-700">
                            Navigating Trade-offs in Luxury Urban Living
                        </summary>
                        <div class="px-4 pb-2 text-gray-700">
                            <p class="text-sm">Selecting a luxury studio in Downtown New Haven involves inherent compromises. Renters must weigh the convenience and vibrancy of a central location against the unavoidable presence of urban noise. The depth of advertised amenities should be balanced with the reality of their consistent availability and maintenance. Pricing, while a primary filter, must be considered in terms of effective rent and the overall value delivered by the property. Ultimately, the quality of property management and its impact on daily living, including rule enforcement and responsiveness, often emerges as a critical determinant of long-term satisfaction. The decision hinges on an individual's priorities and tolerance for these various factors.</p>
                        </div>
                    </details>
                </div>
            </section>

            <section id="recommendations-section" class="mb-20">
                <div class="text-center mb-12">
                    <h2 class="text-4xl font-bold gradient-text mb-4">Recommendations & Key Considerations</h2>
                    <p class="text-xl text-gray-600 max-w-2xl mx-auto">
                        Based on our analysis, here are tailored recommendations and essential next steps for your apartment search.
                    </p>
                </div>
                <div class="grid lg:grid-cols-2 gap-8">
                    <div class="card-modern p-8">
                        <div class="flex items-center mb-6">
                            <div class="feature-icon mr-4">üéØ</div>
                            <h3 class="text-2xl font-semibold">Tailored Recommendations</h3>
                        </div>
                        <div id="tailored-recommendations" class="space-y-6">
                        </div>
                    </div>
                    <div class="card-modern p-8">
                        <div class="flex items-center mb-6">
                            <div class="feature-icon mr-4">‚úÖ</div>
                            <h3 class="text-2xl font-semibold">Essential Due Diligence</h3>
                        </div>
                        <div id="due-diligence" class="space-y-6">
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Enhanced Performance and Animations
            class ModernUI {
                constructor() {
                    this.init();
                }
                
                init() {
                    this.setupLoading();
                    this.setupScrollAnimations();
                    this.setupScrollIndicator();
                    this.setupAccessibility();
                    this.setupNavigation();
                    this.initializeData();
                }
                
                setupLoading() {
                    window.addEventListener('load', () => {
                        const loadingOverlay = document.querySelector('.loading-overlay');
                        setTimeout(() => {
                            loadingOverlay.classList.remove('active');
                        }, 500);
                    });
                }
                
                setupScrollAnimations() {
                    const observerOptions = {
                        threshold: 0.1,
                        rootMargin: '0px 0px -50px 0px'
                    };
                    
                    const observer = new IntersectionObserver((entries) => {
                        entries.forEach(entry => {
                            if (entry.isIntersecting) {
                                entry.target.classList.add('is-visible');
                            }
                        });
                    }, observerOptions);
                    
                    document.querySelectorAll('.scroll-reveal, .scroll-reveal-left, .scroll-reveal-right').forEach(el => {
                        observer.observe(el);
                    });
                }
                
                setupScrollIndicator() {
                    const scrollIndicator = document.querySelector('.scroll-indicator');
                    
                    const updateScrollIndicator = () => {
                        const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                        const scrollHeight = document.documentElement.scrollHeight - window.innerHeight;
                        const scrollPercentage = (scrollTop / scrollHeight) * 100;
                        
                        scrollIndicator.style.transform = `scaleX(${scrollPercentage / 100})`;
                    };
                    
                    window.addEventListener('scroll', updateScrollIndicator, { passive: true });
                }
                
                setupAccessibility() {
                    // Enhanced keyboard navigation
                    document.addEventListener('keydown', (e) => {
                        if (e.key === 'Tab') {
                            document.body.classList.add('keyboard-navigation');
                        }
                    });
                    
                    document.addEventListener('mousedown', () => {
                        document.body.classList.remove('keyboard-navigation');
                    });
                    
                    // Focus management for nav links
                    const navLinks = document.querySelectorAll('.nav-link');
                    navLinks.forEach(link => {
                        link.addEventListener('focus', () => {
                            link.classList.add('focus-visible');
                        });
                        
                        link.addEventListener('blur', () => {
                            link.classList.remove('focus-visible');
                        });
                    });
                }
                
                setupNavigation() {
                    const navLinks = document.querySelectorAll('.nav-link');
                    
                    navLinks.forEach(link => {
                        link.addEventListener('click', (e) => {
                            e.preventDefault();
                            
                            // Remove active class from all links
                            navLinks.forEach(l => l.classList.remove('active'));
                            
                            // Add active class to clicked link
                            link.classList.add('active');
                            
                            // Smooth scroll to section
                            const targetId = link.getAttribute('href').substring(1);
                            const targetElement = document.getElementById(targetId);
                            
                            if (targetElement) {
                                targetElement.scrollIntoView({
                                    behavior: 'smooth',
                                    block: 'start'
                                });
                            }
                        });
                    });
                    
                    // Update active nav link on scroll
                    const sections = document.querySelectorAll('section[id]');
                    const observerOptions = {
                        threshold: 0.6,
                        rootMargin: '-20% 0px -70% 0px'
                    };
                    
                    const navObserver = new IntersectionObserver((entries) => {
                        entries.forEach(entry => {
                            if (entry.isIntersecting) {
                                navLinks.forEach(link => {
                                    link.classList.remove('active');
                                    if (link.getAttribute('href') === `#${entry.target.id}`) {
                                        link.classList.add('active');
                                    }
                                });
                            }
                        });
                    }, observerOptions);
                    
                    sections.forEach(section => navObserver.observe(section));
                }
                
                initializeData() {
                    // Initialize property data
                    this.setupPropertyData();
                    this.setupRecommendationsData();
                    this.setupComparativeTablesData();
                    
                    // Initialize all data and charts
                    this.initializeCharts();
                    this.populateProfiles();
                    this.populateComparativeTables();
                    this.populateRecommendations();
                }
                
                setupPropertyData() {
                    this.propertyData = [
                        {
                            id: 'anthem',
                            name: 'The Anthem at Square 10',
                            overview: 'The Anthem at Square 10 is a newly developed, sustainably designed luxury apartment community in downtown New Haven, representing the initial phase of the larger "Square 10" development. It emphasizes ultra-modern amenities and a vibrant public plaza, aiming to create a new urban living experience where legends once performed.',
                            floorPlansPricing: {
                                range: '$1,795 - $2,335',
                                sqFt: 'Varies (S1, S2, S3, S4, S5)',
                                special: 'Up to two months free on select apartment homes for summer move-ins. Contact leasing office to confirm for studios.',
                                availability: 'Currently Available'
                            },
                            amenities: ['Oasis Pool', 'Health Club', 'Great Hall (Gaming/Co-working)', 'Private Club/Sound Stage', 'Rooftop Deck', 'Indoor/Outdoor Yoga', 'Office Center/Conference Room', 'Club House', 'Public Plaza', 'BBQ/Picnic Areas', 'Proximity to Wooster Square Park'],
                            pros: ['Overwhelmingly positive management feedback', 'No noise complaints', 'Modern amenities', 'Sustainable design', 'Great location'],
                            cons: ['Higher price point', 'Limited availability', 'New construction'],
                            overallLiving: 'Highly positive; "Full contentment," "dream manifested." Modern, walkable location, pet-friendly.',
                            scores: { overall: 4.5, quiet: 4.8, management: 4.9, amenities: 4.3, value: 4.2 }
                        },
                        {
                            id: 'whit',
                            name: 'The Whit',
                            overview: 'The Whit is a contemporary apartment complex in downtown New Haven that combines modern amenities with prime location near Yale University. It features a distinctive courtyard pool and extensive amenities in a vibrant urban setting.',
                            floorPlansPricing: {
                                range: '~$2,400+',
                                sqFt: 'Varies (studio options)',
                                special: 'Up to 2-Months Free (select units)',
                                availability: 'Varies, contact property'
                            },
                            amenities: ['Courtyard Pool', 'Fitness/Yoga Center', 'Club Room', 'Game Room', 'Co-working Space', 'Concierge', 'Rooftop Terrace', 'Dog Park Access'],
                            pros: ['Staff responsive/helpful', 'Modern apartments', 'Great location near Yale', 'Pet-friendly'],
                            cons: ['Major noise concerns', 'Parking issues', 'Slow elevators', 'Can feel generic'],
                            overallLiving: 'Modern, convenient, great location (near Yale). Drawbacks: parking, slow elevators. Can feel generic.',
                            scores: { overall: 3.5, quiet: 2.5, management: 3.8, amenities: 4.0, value: 3.2 }
                        },
                        {
                            id: 'audubon',
                            name: 'The Audubon',
                            overview: 'The Audubon is a luxury apartment complex offering extensive amenities including multiple fitness centers, a golf simulator, and unique features like a sound lounge. It emphasizes premium living with comprehensive recreational facilities.',
                            floorPlansPricing: {
                                range: '$2,269 - $2,490+',
                                sqFt: 'Varies (studios available)',
                                special: 'None explicitly stated',
                                availability: 'August 4, 2025 (S1)'
                            },
                            amenities: ['Multiple Fitness Centers', 'Golf Simulator', 'Game Room', 'Sound Lounge', 'Co-working Space', 'Pool Deck', 'Rooftop Lounge/Gardens', 'Urban Green Space'],
                            pros: ['Extensive amenities', 'Multiple fitness centers', 'Unique sound lounge', 'Premium location'],
                            cons: ['Major noise issues', 'Inconsistent management', 'Safety concerns', 'High price'],
                            overallLiving: 'Mixed; "Glorified dorm" or "nightmare" due to noise/management. Safety concerns (garage break-ins). Good location.',
                            scores: { overall: 2.8, quiet: 2.0, management: 2.5, amenities: 4.5, value: 2.8 }
                        },
                        {
                            id: 'state360',
                            name: '360 State Street',
                            overview: '360 State Street is a luxury high-rise featuring a rooftop heated pool and comprehensive amenities. It offers urban living with premium features including concierge services and extensive common spaces.',
                            floorPlansPricing: {
                                range: '$2,304+',
                                sqFt: 'Varies (studios available)',
                                special: 'Up to 2-Months Free (select units)',
                                availability: 'Varies, contact property'
                            },
                            amenities: ['Rooftop Heated Pool', 'Fitness Center', 'Co-working Space', 'Game Room', 'Golf Simulator', 'Concierge', 'Rooftop Deck', 'Grilling Stations'],
                            pros: ['Prime location', 'Heated rooftop pool', 'Nice community', 'Maintenance praised'],
                            cons: ['Overpriced', 'Noise issues', 'Management problems', 'Amenity degradation'],
                            overallLiving: 'Prime location, nice community, but overpriced. Amenities degrading, common spaces limited hours.',
                            scores: { overall: 3.2, quiet: 2.8, management: 3.0, amenities: 3.8, value: 2.9 }
                        },
                        {
                            id: 'corsair',
                            name: 'Corsair Apartments',
                            overview: 'Corsair Apartments provides a neighborhood feel with extensive outdoor amenities including bocce court, pizza oven, and movie theater. It emphasizes community living with diverse recreational options.',
                            floorPlansPricing: {
                                range: '$2,337+',
                                sqFt: 'Varies (studios available)',
                                special: 'None explicitly stated',
                                availability: 'Varies, contact property'
                            },
                            amenities: ['Heated Courtyard Pool', 'Fitness Center (Peloton)', 'Game Room', 'Library', 'Movie Room', 'Business Center', 'Bocce Court', 'Pizza Oven', 'Lawnside Movie Theater'],
                            pros: ['Old-fashioned neighborhood feel', 'Excellent amenities', 'Dog-friendly', 'Positive management'],
                            cons: ['Traffic noise from highway', 'Frequent fire alarms', 'High utility costs', 'Homeless population nearby'],
                            overallLiving: 'Positive; "At home," "old fashioned neighborhood" feel. Drawbacks: street parking, homeless population nearby, high utility costs.',
                            scores: { overall: 3.8, quiet: 3.0, management: 3.9, amenities: 4.2, value: 3.5 }
                        }
                    ];
                }
                
                setupRecommendationsData() {
                    this.recommendationsData = {
                        tailored: [
                            {
                                title: 'For Budget-Conscious Luxury Seekers:',
                                text: '<strong>The Anthem at Square 10</strong> offers the most competitive rents and valuable "months free" specials, providing premium amenities at the best value.'
                            },
                            {
                                title: 'For Those Prioritizing Quiet:',
                                text: 'While no downtown location is silent, <strong>The Anthem at Square 10</strong> is the standout, with no negative noise complaints in resident reviews, a major differentiator.'
                            },
                            {
                                title: 'For Amenity Enthusiasts:',
                                text: '<strong>The Audubon</strong> and <strong>360 State Street</strong> offer the most extensive lists of amenities, including unique features like sound lounges and a rooftop pool. <strong>Corsair</strong> also provides a wide array of recreational outdoor amenities.'
                            },
                            {
                                title: 'For Strong Management Preference:',
                                text: '<strong>The Anthem at Square 10</strong> receives consistently and overwhelmingly positive feedback for its helpful and attentive staff, suggesting a smoother living experience.'
                            }
                        ],
                        diligence: [
                            {
                                title: 'Verify Effective Rent',
                                text: 'Contact leasing offices to confirm specials and calculate your true monthly cost over the lease term.'
                            },
                            {
                                title: 'Conduct Multiple In-Person Tours',
                                text: 'Visit at different times (day, night, weekend) to assess real-world noise levels and community vibe.'
                            },
                            {
                                title: 'Engage with Current Residents',
                                text: 'If possible, ask residents about their experiences with management, noise, and amenity upkeep.'
                            },
                            {
                                title: 'Inquire About Rule Enforcement',
                                text: 'Ask management directly how they handle noise complaints and enforce community rules to gauge their effectiveness.'
                            },
                            {
                                title: 'Consider Long-Term Outlook',
                                text: 'Reflect on potential future changes that could impact the living experience over time, including possible shifts in management, planned construction, or evolving resident demographics.'
                            }
                        ]
                    };
                }
                
                setupComparativeTablesData() {
                    this.comparativeTablesData = {
                        studioComparison: [
                            {
                                propertyName: '360 State Street',
                                priceRange: '$2,304+',
                                specials: 'Up to 2-Months Free (select units)',
                                poolType: 'Rooftop (Heated)',
                                commonSpaces: 'Fitness, Co-working, Game Room, Golf Sim, Concierge',
                                outdoorSpaces: 'Rooftop Deck, Cabanas, Grilling Stations, Green Space',
                                availability: 'Varies, contact property'
                            },
                            {
                                propertyName: 'The Whit',
                                priceRange: '~$2,400+',
                                specials: 'Up to 2-Months Free (select units)',
                                poolType: 'Courtyard',
                                commonSpaces: 'Fitness/Yoga, Club Room, Game Room, Co-working, Concierge',
                                outdoorSpaces: 'Rooftop Terrace (Bar, BBQ, Fire Pits), Courtyard, Dog Park (nearby)',
                                availability: 'Varies, contact property'
                            },
                            {
                                propertyName: 'The Audubon',
                                priceRange: '$2,269 - $2,490+',
                                specials: 'None explicitly stated',
                                poolType: 'Pool Deck',
                                commonSpaces: 'Multiple Fitness Centers, Golf Sim, Game Room, Sound Lounge, Co-working',
                                outdoorSpaces: 'Rooftop Lounge/Gardens, Grill/Cabana, Urban Green Space, Bonfire Pit',
                                availability: 'August 4, 2025 (S1)'
                            },
                            {
                                propertyName: 'The Anthem at Square 10',
                                priceRange: '$1,795 - $2,335',
                                specials: 'Up to 2-Months Free (select units)',
                                poolType: 'Outdoor Oasis',
                                commonSpaces: 'Health Club, Great Hall (Gaming, Co-working), Private Club/Sound Stage, Cafe',
                                outdoorSpaces: 'Courtyard, Public Plaza, Roof Deck, Indoor/Outdoor Yoga, BBQ/Picnic',
                                availability: 'Currently Available'
                            },
                            {
                                propertyName: 'Corsair Apartments',
                                priceRange: '$2,337+',
                                specials: 'None explicitly stated',
                                poolType: 'Heated Courtyard Pool',
                                commonSpaces: 'Fitness Center (Peloton), Game Room, Library, Movie Room, Business Center, Package Concierge',
                                outdoorSpaces: 'Cabanas, Bocce Court, Fire Pit, Grilling Stations, Pizza Oven, Lawnside Movie Theater, Roof Deck',
                                availability: 'Varies, contact property'
                            }
                        ],
                        residentExperience: [
                            {
                                propertyName: '360 State Street',
                                management: 'Mixed; Maintenance praised, leasing office confused/obstructive. New management (South Oxford) criticized for degradation, poor communication, safety issues.',
                                noise: 'Significant concern; Street, train, thin walls. Loud music, sirens, train horns common.',
                                overallLiving: 'Prime location, nice community, but overpriced. Amenities degrading, common spaces limited hours.',
                                petIssues: 'Pet-friendly.'
                            },
                            {
                                propertyName: 'The Whit',
                                management: 'Mixed; Staff responsive/helpful, but inconsistent rule enforcement (pets). Some find management uncaring.',
                                noise: 'Major concern; LOUD downtown noise (bikes, stereos, drag racing), frequent train sounds. Unit-to-unit quiet.',
                                overallLiving: 'Modern, convenient, great location (near Yale). Drawbacks: parking, slow elevators. Can feel generic.',
                                petIssues: 'Pet-friendly, but poor rule enforcement (barking, pee, pool deck).'
                            },
                            {
                                propertyName: 'The Audubon',
                                management: 'Highly polarized; Praised as "super nice" by some, but others find them incompetent, unconcerned, not enforcing rules (noise, safety).',
                                noise: 'Major concern; Loud, inconsiderate neighbors ("frat house" vibe). Rules not enforced.',
                                overallLiving: 'Mixed; "Glorified dorm" or "nightmare" due to noise/management. Safety concerns (garage break-ins). Good location.',
                                petIssues: 'Pet-friendly.'
                            },
                            {
                                propertyName: 'The Anthem at Square 10',
                                management: 'Overwhelmingly positive; Staff helpful, patient, courteous, attentive.',
                                noise: 'No negative comments reported.',
                                overallLiving: 'Highly positive; "Full contentment," "dream manifested." Modern, walkable location, pet-friendly.',
                                petIssues: 'Pet-friendly.'
                            },
                            {
                                propertyName: 'Corsair Apartments',
                                management: 'Mixed; Many praise management and maintenance. Some report communication breakdowns, closing shared amenities for private events.',
                                noise: 'Mixed; Official rating 5/5, but others report "significant traffic noise from highway 91" that is "24/7" and disruptive. Frequent fire alarms.',
                                overallLiving: 'Positive; "At home," "old fashioned neighborhood" feel. Drawbacks: street parking, homeless population nearby, high utility costs, can feel like a dorm.',
                                petIssues: 'Dog-friendly.'
                            }
                        ]
                    };
                }
                
                initializeCharts() {
                    const ctx = document.getElementById('property-chart').getContext('2d');
                    this.propertyChart = null;
                    
                    document.getElementById('priority-filter').addEventListener('change', (e) => {
                        this.updateChart(e.target.value);
                    });
                    
                    this.updateChart('overall');
                }
                
                updateChart(metric) {
                    this.propertyData.sort((a, b) => {
                        if (metric === 'value') {
                            return a.floorPlansPricing.range.split('-')[0].replace(/[^0-9.]/g, '') - b.floorPlansPricing.range.split('-')[0].replace(/[^0-9.]/g, '');
                        }
                        return b.scores[metric] - a.scores[metric];
                    });

                    const labels = this.propertyData.map(p => p.name);
                    const data = this.propertyData.map(p => metric === 'value' ? p.floorPlansPricing.range.split('-')[0].replace(/[^0-9.]/g, '') : p.scores[metric]);

                    let labelText = '';
                    let backgroundColor = 'rgba(13, 148, 136, 0.6)';
                    let borderColor = 'rgba(13, 148, 136, 1)';
                    let hoverBackgroundColor = 'rgba(15, 118, 110, 1)';

                    switch(metric) {
                        case 'value':
                            labelText = 'Starting Studio Price ($)';
                            backgroundColor = 'rgba(59, 130, 246, 0.6)';
                            borderColor = 'rgba(59, 130, 246, 1)';
                            hoverBackgroundColor = 'rgba(37, 99, 235, 1)';
                            break;
                        case 'quiet':
                            labelText = 'Quiet Score (out of 5)';
                            backgroundColor = 'rgba(168, 85, 247, 0.6)';
                            borderColor = 'rgba(168, 85, 247, 1)';
                            hoverBackgroundColor = 'rgba(147, 51, 234, 1)';
                            break;
                        case 'management':
                            labelText = 'Management Score (out of 5)';
                            backgroundColor = 'rgba(234, 179, 8, 0.6)';
                            borderColor = 'rgba(234, 179, 8, 1)';
                            hoverBackgroundColor = 'rgba(202, 138, 4, 1)';
                            break;
                        case 'amenities':
                            labelText = 'Amenity Score (out of 5)';
                            backgroundColor = 'rgba(239, 68, 68, 0.6)';
                            borderColor = 'rgba(239, 68, 68, 1)';
                            hoverBackgroundColor = 'rgba(220, 38, 38, 1)';
                            break;
                        default:
                            labelText = 'Overall Score (out of 5)';
                    }

                    if (this.propertyChart) {
                        this.propertyChart.destroy();
                    }

                    const ctx = document.getElementById('property-chart').getContext('2d');
                    this.propertyChart = new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: labels,
                            datasets: [{
                                label: labelText,
                                data: data,
                                backgroundColor: backgroundColor,
                                borderColor: borderColor,
                                borderWidth: 1,
                                hoverBackgroundColor: hoverBackgroundColor,
                                borderRadius: 4,
                            }]
                        },
                        options: {
                            indexAxis: 'y',
                            maintainAspectRatio: false,
                            responsive: true,
                            scales: {
                                x: {
                                    beginAtZero: metric !== 'value',
                                    grid: {
                                        drawOnChartArea: false
                                    }
                                },
                                y: {
                                    grid: {
                                        display: false
                                    }
                                }
                            },
                            plugins: {
                                legend: {
                                    display: false
                                },
                                tooltip: {
                                    callbacks: {
                                        label: function(context) {
                                            let label = context.dataset.label || '';
                                            if (label) {
                                                label += ': ';
                                            }
                                            if (context.parsed.x !== null) {
                                                if(metric === 'value') {
                                                   label += new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', minimumFractionDigits: 0 }).format(context.parsed.x);
                                                } else {
                                                   label += context.parsed.x;
                                                }
                                            }
                                            return label;
                                        }
                                    }
                                }
                            }
                        }
                    });
                }
                
                populateProfiles() {
                    const container = document.getElementById('property-profiles-container');
                    this.propertyData.forEach((p, index) => {
                        const amenityIcons = {
                            'pool': 'üèä', 'fitness': 'üí™', 'game': 'üéÆ', 'co-working': 'üíº', 'rooftop': 'üåá', 'concierge': 'üõéÔ∏è', 'yoga': 'üßò', 'golf': '‚õ≥', 'library': 'üìö', 'movie': 'üé¨', 'bocce': 'üé≥', 'pizza': 'üçï', 'sound': 'üéß', 'bike': 'üö≤', 'club': 'ü•Ç', 'plaza': 'üå≥'
                        };
                        const getIcon = (amenity) => {
                            const lowerAmenity = amenity.toLowerCase();
                            for (const key in amenityIcons) {
                                if (lowerAmenity.includes(key)) return amenityIcons[key];
                            }
                            return '‚≠ê';
                        };

                        const profileHTML = `
                            <article id="${p.id}" class="property-card p-8 scroll-mt-24 scroll-reveal" style="transition-delay: ${index * 0.1}s;">
                               <div class="flex items-start justify-between mb-6">
                                   <div>
                                       <h3 class="text-3xl font-bold gradient-text mb-2">${p.name}</h3>
                                       <div class="flex items-center space-x-4">
                                           <span class="bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm font-medium">
                                               Overall Score: ${p.scores.overall}/5
                                           </span>
                                           <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium">
                                               ${p.floorPlansPricing.range}
                                           </span>
                                       </div>
                                   </div>
                                   <div class="feature-icon will-change-transform">üè¢</div>
                               </div>

                               <div class="mb-8">
                                    <h4 class="text-xl font-semibold mb-4 flex items-center">
                                        <span class="mr-2">üìñ</span> Overview
                                    </h4>
                                    <p class="text-gray-700 leading-relaxed">${p.overview}</p>
                               </div>

                               <div class="grid lg:grid-cols-2 gap-8 mb-8">
                                    <div class="bg-gray-50 p-6 rounded-xl">
                                        <h4 class="text-xl font-semibold mb-4 flex items-center">
                                            <span class="mr-2">üí∞</span> Pricing & Plans
                                        </h4>
                                        <div class="space-y-3">
                                            <p class="text-gray-700"><strong>Price Range:</strong> <span class="text-purple-600 font-medium">${p.floorPlansPricing.range}</span></p>
                                            <p class="text-gray-700"><strong>Size:</strong> ${p.floorPlansPricing.sqFt}</p>
                                            <p class="text-gray-700"><strong>Special:</strong> <span class="text-amber-600 font-medium">${p.floorPlansPricing.special}</span></p>
                                            <p class="text-gray-700"><strong>Availability:</strong> <span class="text-green-600 font-medium">${p.floorPlansPricing.availability}</span></p>
                                        </div>
                                    </div>
                                    <div class="bg-gray-50 p-6 rounded-xl">
                                        <h4 class="text-xl font-semibold mb-4 flex items-center">
                                            <span class="mr-2">üéØ</span> Amenities
                                        </h4>
                                        <div class="grid grid-cols-2 gap-3">
                                            ${p.amenities.slice(0, 8).map(a => `<div class="flex items-center bg-white px-3 py-2 rounded-lg shadow-sm"><span class="mr-2">${getIcon(a)}</span><span class="text-sm">${a}</span></div>`).join('')}
                                        </div>
                                        ${p.amenities.length > 8 ? `<p class="text-sm text-gray-500 mt-3">+ ${p.amenities.length - 8} more amenities</p>` : ''}
                                    </div>
                               </div>

                               <div class="mb-8">
                                    <h4 class="text-xl font-semibold mb-4 flex items-center">
                                        <span class="mr-2">üè†</span> Resident Experience
                                    </h4>
                                    <div class="grid lg:grid-cols-2 gap-6">
                                        <div class="bg-green-50 p-6 rounded-xl">
                                            <h5 class="font-semibold text-green-800 mb-3 flex items-center">
                                                <span class="mr-2">‚úÖ</span> Pros
                                            </h5>
                                            <ul class="space-y-2">
                                                ${p.pros.slice(0, 4).map(pro => `<li class="text-sm text-green-700 flex items-start"><span class="mr-2 mt-1">‚Ä¢</span>${pro}</li>`).join('')}
                                            </ul>
                                        </div>
                                        <div class="bg-red-50 p-6 rounded-xl">
                                            <h5 class="font-semibold text-red-800 mb-3 flex items-center">
                                                <span class="mr-2">‚ö†Ô∏è</span> Cons
                                            </h5>
                                            <ul class="space-y-2">
                                                ${p.cons.slice(0, 4).map(con => `<li class="text-sm text-red-700 flex items-start"><span class="mr-2 mt-1">‚Ä¢</span>${con}</li>`).join('')}
                                            </ul>
                                        </div>
                                    </div>
                               </div>

                               <div class="bg-blue-50 p-6 rounded-xl">
                                    <h4 class="text-xl font-semibold mb-4 flex items-center">
                                        <span class="mr-2">üåü</span> Living Experience Summary
                                    </h4>
                                    <p class="text-gray-700 leading-relaxed">${p.overallLiving}</p>
                               </div>
                            </article>
                        `;
                        container.innerHTML += profileHTML;
                    });
                }
                
                populateComparativeTables() {
                    const comparisonTableBody = document.getElementById('comparison-table-body');
                    this.comparativeTablesData.studioComparison.forEach(row => {
                        const tr = document.createElement('tr');
                        tr.className = 'hover:bg-gray-50 transition-colors';
                        tr.innerHTML = `
                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${row.propertyName}</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-purple-600 font-medium">${row.priceRange}</td>
                            <td class="px-6 py-4 whitespace-normal text-sm text-gray-700">${row.specials}</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-700">${row.poolType}</td>
                            <td class="px-6 py-4 whitespace-normal text-sm text-gray-700">${row.commonSpaces}</td>
                            <td class="px-6 py-4 whitespace-normal text-sm text-gray-700">${row.outdoorSpaces}</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-green-600 font-medium">${row.availability}</td>
                        `;
                        comparisonTableBody.appendChild(tr);
                    });

                    const residentExperienceTableBody = document.getElementById('resident-experience-table-body');
                    this.comparativeTablesData.residentExperience.forEach(row => {
                        const tr = document.createElement('tr');
                        tr.className = 'hover:bg-gray-50 transition-colors';
                        tr.innerHTML = `
                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${row.propertyName}</td>
                            <td class="px-6 py-4 whitespace-normal text-sm text-gray-700">${row.management}</td>
                            <td class="px-6 py-4 whitespace-normal text-sm text-gray-700">${row.noise}</td>
                            <td class="px-6 py-4 whitespace-normal text-sm text-gray-700">${row.overallLiving}</td>
                            <td class="px-6 py-4 whitespace-normal text-sm text-gray-700">${row.petIssues}</td>
                        `;
                        residentExperienceTableBody.appendChild(tr);
                    });
                }
                
                populateRecommendations() {
                    const tailoredContainer = document.getElementById('tailored-recommendations');
                    const diligenceContainer = document.getElementById('due-diligence');

                    this.recommendationsData.tailored.forEach(rec => {
                        tailoredContainer.innerHTML += `
                            <div class="bg-purple-50 p-4 rounded-lg">
                                <h4 class="font-semibold text-purple-800 mb-2">${rec.title}</h4>
                                <p class="text-sm text-gray-700">${rec.text}</p>
                            </div>
                        `;
                    });

                    this.recommendationsData.diligence.forEach(rec => {
                        diligenceContainer.innerHTML += `
                            <div class="bg-blue-50 p-4 rounded-lg">
                                <h4 class="font-semibold text-blue-800 mb-2">${rec.title}</h4>
                                <p class="text-sm text-gray-700">${rec.text}</p>
                            </div>
                        `;
                    });
                }
            }
            
            // Property data
            ui.propertyData = [
                {
                    id: 'anthem',
                    name: 'The Anthem at Square 10',
                    overview: 'The Anthem at Square 10 is a newly developed, sustainably designed luxury apartment community in downtown New Haven, representing the initial phase of the larger "Square 10" development. It emphasizes ultra-modern amenities and a vibrant public plaza, aiming to create a new urban living experience where legends once performed.',
                    floorPlansPricing: {
                        range: '$1,795 - $2,335',
                        sqFt: 'Varies (S1, S2, S3, S4, S5)',
                        special: 'Up to two months free on select apartment homes for summer move-ins. Contact leasing office to confirm for studios.',
                        availability: 'Currently Available'
                    },
                    amenities: ['Oasis Pool', 'Health Club', 'Great Hall (Gaming/Co-working)', 'Private Club/Sound Stage', 'Rooftop Deck', 'Indoor/Outdoor Yoga', 'Office Center/Conference Room', 'Club House', 'Public Plaza', 'BBQ/Picnic Areas', 'Proximity to Wooster Square Park'],
                    scores: { value: 5, quiet: 5, management: 5, amenities: 5, overall: 5 },
                    pros: [
                        'Overwhelmingly positive feedback on management (helpful, patient, courteous, attentive).',
                        'No negative noise complaints in resident reviews, a significant differentiator downtown.',
                        'Striking, ultra-modern, and top-tier amenities (some of the best in the area).',
                        'Highly competitive pricing, often below budget, with valuable "months free" specials.',
                        'Excellent walkable location near the train station, Wooster Square, and dining options.',
                        'Very beautiful and incredible building with top-notch finishes and appliances.',
                        'Pet-friendly community.'
                    ],
                    cons: [
                        'Specials may not apply to all studio units; direct confirmation needed.',
                        'As a new development, surrounding construction may occur.',
                        'Specific details on studio square footage not always explicit in general listings.'
                    ],
                    overallLiving: 'Residents express high satisfaction, describing their living experience as "full contentment" and a "dream manifested." The location is highly valued for its walkability. As part of a new and innovative neighborhood development, it suggests a modern and evolving urban environment. The combination of attractive pricing, strong promotional offers, and consistently positive resident feedback (especially the absence of common downtown complaints like noise and poor management) suggests that The Anthem at Square 10 offers a superior value proposition and potentially a higher quality of life for the user.'
                },
                {
                    id: '360state',
                    name: '360 State Street',
                    overview: '360 State Street stands as a prominent high-rise luxury apartment building in the heart of downtown New Haven. It is distinguished by its modern architectural design, featuring expansive floor-to-ceiling windows and premium in-unit amenities such as stainless-steel appliances and in-unit washers and dryers. The property aims to provide a sophisticated urban living experience.',
                    floorPlansPricing: {
                        range: '$2,304+',
                        sqFt: 'Varies (studio units available, 1-bedrooms from $2,279)',
                        special: 'Up to 2-Months Free Rent On Selected Apartment Homes. Verify if applicable to studios.',
                        availability: 'Varies, contact property'
                    },
                    amenities: ['Heated Rooftop Pool', 'Private Cabanas', 'Grilling Stations', 'Golf Simulator', 'Game Room', '24/7 Concierge', 'Coworking Spaces', 'Fully Equipped Fitness Center', 'Spacious Club Room with Catering Kitchen', 'Serene Green Space', 'EV Charging Stations', 'Ample Onsite Private Parking (additional cost)', 'In-unit Washer/Dryer', 'Modern Finishes (floor-to-ceiling windows, stainless-steel appliances)'],
                    scores: { value: 3, quiet: 2, management: 2, amenities: 5, overall: 3 },
                    pros: [
                        'Unique heated rooftop pool with private cabanas.',
                        'Prime, central downtown location, highly walkable to Yale, restaurants, and attractions.',
                        'Maintenance team is consistently praised for being "friendly and fast working" and timely.',
                        'Good mix of social events and friendly community.',
                        'Modern finishes (floor-to-ceiling windows, stainless-steel appliances), in-unit washer/dryer.',
                        'Pet-friendly.'
                    ],
                    cons: [
                        'Significant noise from street (entertainment facilities, loud music, motorcycles), frequent sirens and train horns.',
                        '"Paper thin walls" and building structure transmit internal noise (e.g., from gym).',
                        'New management (South Oxford) criticized for "slow degradation in amenities and building upkeep".',
                        'Malfunctioning gym equipment (treadmills, rowing machines, stationary bikes) needing better maintenance.',
                        'Prolonged closure of ground-floor grocery store (replacement tenant "months overdue").',
                        'Leasing office described as "confused at best and obstructive at worst" with poor communication (mishandled rent payments, fire alarms).',
                        'Parking garage made public, leading to safety concerns and reported theft.',
                        'Rent considered "very overpriced" for current quality; common spaces locked after 10 pm.'
                    ],
                    overallLiving: 'The prime downtown location is a major advantage, offering quick access to restaurants, shopping, and the train station. The community is generally described as "nice" and "friendly," with a good mix of social events. However, despite the luxurious feel, some residents find the rent "very overpriced" given the perceived decline in amenity quality and the fact that common spaces like the club room are locked after 10 pm, limiting evening social use.'
                },
                {
                    id: 'whit',
                    name: 'The Whit',
                    overview: 'The Whit is strategically located at the gateway to the historic Wooster Square, offering modern luxury apartments and two-story lofts. The property is designed to blend contemporary aesthetics with the neighborhood\'s historic charm, providing elegant features and a comprehensive suite of amenities.',
                    floorPlansPricing: {
                        range: '~$2,400+',
                        sqFt: 'Studio apartment homes available',
                        special: 'UP TO TWO MONTHS FREE on select apartment homes. Direct contact recommended for precise studio pricing and availability.',
                        availability: 'Varies, contact property'
                    },
                    amenities: ['Resort-Style Pool (2nd-floor landscaped courtyard)', 'Fitness Center with Yoga Studio', 'Spacious Club Room with Catering Kitchen', 'Game Room (ping pong, shuffleboard)', 'Business Lounge with Co-working Spaces', 'Reservable Individual Offices', 'Rooftop Terrace (bar, lounge, BBQ grills, fire pits)', 'Concierge and Package Acceptance', 'On-site Restaurants (ROLi and La Fenice)', 'Indoor Bike Storage', 'Guest Suites', 'Modern Finishes (quartz countertops, stainless appliances)', 'In-unit Laundry'],
                    scores: { value: 2, quiet: 2, management: 3, amenities: 4, overall: 2.8 },
                    pros: [
                        'Amenities are generally praised as "top-notch" and consistently "clean".',
                        'Apartments feature "sleek with high-end finishes" and abundant natural light.',
                        'Great location near Yale and Wooster Square, "steps from Yale, shops, and restaurants".',
                        'Policy of not allowing undergraduates is viewed positively by some, contributing to a perceived better atmosphere.',
                        'Staff can be "responsive and thoughtful," "incredible," "communicative and helpful," facilitating "seamless" transitions.'
                    ],
                    cons: [
                        'Major concerns with loud downtown noise (dirt bikes, Harleys, loud stereos, drag racing, train sounds).',
                        'Inconsistent enforcement of pet rules (barking dogs, pet waste in elevators, dogs in prohibited areas like pool deck).',
                        'Management staff can be perceived as "unreliable, inconsistent, and often seems as if they do not care".',
                        'Gym is noted as "small and frequently crowded at peak times".',
                        'Pool deck is often "super windy," making outdoor dining challenging.',
                        'EV chargers reported problematic for non-Tesla vehicles.',
                        '"Tiny" in-unit washer/dryers, old or smelly dishwashers, refrigerators that consistently freeze food.',
                        'Parking difficulties for visitors and slow elevators in a 32-floor building.'
                    ],
                    overallLiving: 'The Whit is generally perceived as offering a "modern, convenient lifestyle" and a "great home" due to its highly desirable location. Practical drawbacks include parking difficulties for visitors and slow elevators. Some residents describe the building as a "fairly generic, fairly unimpressive developer building with no personality rented at very high prices".'
                },
                {
                    id: 'audubon',
                    name: 'The Audubon New Haven',
                    overview: 'The Audubon is strategically positioned at the gateway to New Haven\'s cultural and culinary scene, offering luxury rentals across its three buildings. The property emphasizes thoughtful design, aiming to facilitate a seamless integration of work and life for its residents.',
                    floorPlansPricing: {
                        range: '$2,269 - $2,490+',
                        sqFt: 'Studio (S1) floor plans, typically around 540 Sq. Ft.',
                        special: 'None explicitly mentioned.',
                        availability: 'August 4, 2025 (S1)'
                    },
                    amenities: ['Pool Deck', 'Multiple Fitness Centers (cross-fit areas, punching bags, dance room)', 'Golf Simulator', 'Game Room with Bar Area', 'Sound Lounge Music Studio', 'Zoom-friendly Quiet Work Rooms', 'Various Lounge Areas', 'Private Working Spaces for Larger Groups', 'Dinner Party Room with Demonstration Kitchen', 'Co-working Spaces', 'Private Outdoor Areas (some units)', 'Rooftop Lounge with Resident Gardens', 'Rooftop Grill and Cabana', 'Urban Green Space', 'Bonfire Pit'],
                    scores: { value: 3, quiet: 1, management: 1, amenities: 5, overall: 2.5 },
                    pros: [
                        'Extensive and "amazing" array of amenities, considered among the "best amenities" compared to similar properties.',
                        'Modern units with "top notch" in-unit appliances.',
                        'Highly walkable location in the arts district, convenient to downtown attractions.',
                        'Building architecture and landscaping are well-regarded.',
                        'Some residents find staff "super nice" and "wonderful".'
                    ],
                    cons: [
                        'Major noise issues; "loud and soooo inconsiderate" neighbors who treat the building like a "frat house".',
                        'Noise rules (after 10 pm) reportedly not enforced by management.',
                        'Noticeable "shift in clientele" towards a "party central" atmosphere.',
                        'Management is highly polarized: often seen as "incompetent," "so bad," "overpromise and underdeliver," and "only care about money".',
                        'Failure to enforce noise rules and lack of transparency regarding car break-ins in the garage.',
                        'Pool reported out of service for extended periods or inaccessible during holidays due to shared access.',
                        'Internet connectivity issues in common areas, particularly work-from-home spaces.'
                    ],
                    overallLiving: 'The living experience is highly mixed. Some residents describe it as a "glorified dorm" and a "nightmare" due to unaddressed resident behavior and management issues. Safety concerns are raised due to reported car break-ins and thefts in the garage. Conversely, others find it a "great home" with "wonderful space" and appreciate the building\'s architecture and landscaping. Despite the advertised luxury, some residents perceive it as "overpriced for the quality" of the actual living experience.'
                },
                {
                    id: 'corsair',
                    name: 'Corsair Apartments',
                    overview: 'Corsair Apartments, located on upper State Street in the East Rock neighborhood, offers modern comfort within a historic, refurbished industrial building. It preserves original materials like pine beams and steel trusses, providing a unique aesthetic. The East Rock location offers easy access to local hangouts and park spaces.',
                    floorPlansPricing: {
                        range: '$2,337+',
                        sqFt: 'Studio floor plans available',
                        special: 'None explicitly mentioned.',
                        availability: 'Varies, contact property'
                    },
                    amenities: ['Heated Courtyard Pool', 'Fully Equipped Fitness Center with Peloton Cycle equipment', 'Game Room', 'Library', 'Movie Room', 'Business Center', 'Package Concierge Service', 'Decked-out Cabanas', 'Bocce Court', 'Fire Pit', 'Grilling Stations', 'Pizza Oven', 'Lawnside Movie Theater', 'Roof Deck'],
                    scores: { value: 2, quiet: 3, management: 4, amenities: 4, overall: 3.3 },
                    pros: [
                        'Amenities are generally highly praised as "amazing" and "excellent," including the gym, pool, and rooftop.',
                        'Gym is specifically noted as "very nice, clean, and well-stocked".',
                        'Management receives high praise from many (professionalism, attentiveness).',
                        'Maintenance staff is consistently described as "prompt," "incredible," and "professional".',
                        'Many residents describe a positive living experience, feeling "at home".',
                        'Appreciated "old fashioned neighborhood" feel of East Rock.',
                        'Location valued for proximity to restaurants and parks, offering urban access without being directly in the city center.',
                        'Community is dog-friendly.'
                    ],
                    cons: [
                        'Some residents report that "many of the amenities they show you on the tour won\'t consistently be available".',
                        'Issues with landscaping and malfunctioning gym televisions noted.',
                        'Some reviews indicate communication breakdowns with management (ceasing communication on complex issues, closing shared amenities for private events).',
                        'Mixed noise feedback: official rating 5/5, but others report "significant traffic noise from highway 91" that is "24/7" and disruptive.',
                        'Frequent fire alarms are a complaint.',
                        'Difficulties with street parking due to nearby attractions.',
                        'Concerns about the local homeless population near the State Street bridge.',
                        'Some found it "more like a dorm than a luxury experience" and expressed concerns about safety in the broader New Haven area.',
                        'Utility costs noted as high.'
                    ],
                    overallLiving: 'Many residents describe a positive living experience, feeling "at home" and praising the "old fashioned neighborhood" feel of East Rock. The location is valued for its proximity to restaurants and parks, offering a balance of urban access without being directly in the city center. Negative aspects include difficulties with street parking and concerns about the local homeless population. Some found it "more like a dorm than a luxury experience" and expressed concerns about safety in the broader New Haven area. Utility costs were also noted as high.'
                }
            ];

            const recommendationsData = {
                tailored: [
                    {
                        title: 'For Budget-Conscious Luxury Seekers:',
                        text: '<strong>The Anthem at Square 10</strong> offers the most competitive rents and valuable "months free" specials, providing premium amenities at the best value.'
                    },
                    {
                        title: 'For Those Prioritizing Quiet:',
                        text: 'While no downtown location is silent, <strong>The Anthem at Square 10</strong> is the standout, with no negative noise complaints in resident reviews, a major differentiator.'
                    },
                    {
                        title: 'For Amenity Enthusiasts:',
                        text: '<strong>The Audubon</strong> and <strong>360 State Street</strong> offer the most extensive lists of amenities, including unique features like sound lounges and a rooftop pool. <strong>Corsair</strong> also provides a wide array of recreational outdoor amenities.'
                    },
                    {
                        title: 'For Strong Management Preference:',
                        text: '<strong>The Anthem at Square 10</strong> receives consistently and overwhelmingly positive feedback for its helpful and attentive staff, suggesting a smoother living experience.'
                    }
                ],
                diligence: [
                    {
                        title: 'Verify Effective Rent',
                        text: 'Contact leasing offices to confirm specials and calculate your true monthly cost over the lease term.'
                    },
                    {
                        title: 'Conduct Multiple In-Person Tours',
                        text: 'Visit at different times (day, night, weekend) to assess real-world noise levels and community vibe.'
                    },
                    {
                        title: 'Engage with Current Residents',
                        text: 'If possible, ask residents about their experiences with management, noise, and amenity upkeep.'
                    },
                    {
                        title: 'Inquire About Rule Enforcement',
                        text: 'Ask management directly how they handle noise complaints and enforce community rules to gauge their effectiveness.'
                    },
                    {
                        title: 'Consider Long-Term Outlook',
                        text: 'Reflect on potential future changes that could impact the living experience over time, including possible shifts in management, planned construction, or evolving resident demographics.'
                    }
                ]
            };

            const comparativeTablesData = {
                studioComparison: [
                    {
                        propertyName: '360 State Street',
                        priceRange: '$2,304+',
                        specials: 'Up to 2-Months Free (select units)',
                        poolType: 'Rooftop (Heated)',
                        commonSpaces: 'Fitness, Co-working, Game Room, Golf Sim, Concierge',
                        outdoorSpaces: 'Rooftop Deck, Cabanas, Grilling Stations, Green Space',
                        availability: 'Varies, contact property'
                    },
                    {
                        propertyName: 'The Whit',
                        priceRange: '~$2,400+',
                        specials: 'Up to 2-Months Free (select units)',
                        poolType: 'Courtyard',
                        commonSpaces: 'Fitness/Yoga, Club Room, Game Room, Co-working, Concierge',
                        outdoorSpaces: 'Rooftop Terrace (Bar, BBQ, Fire Pits), Courtyard, Dog Park (nearby)',
                        availability: 'Varies, contact property'
                    },
                    {
                        propertyName: 'The Audubon',
                        priceRange: '$2,269 - $2,490+',
                        specials: 'None explicitly stated',
                        poolType: 'Pool Deck',
                        commonSpaces: 'Multiple Fitness Centers, Golf Sim, Game Room, Sound Lounge, Co-working',
                        outdoorSpaces: 'Rooftop Lounge/Gardens, Grill/Cabana, Urban Green Space, Bonfire Pit',
                        availability: 'August 4, 2025 (S1)'
                    },
                    {
                        propertyName: 'The Anthem at Square 10',
                        priceRange: '$1,795 - $2,335',
                        specials: 'Up to 2-Months Free (select units)',
                        poolType: 'Outdoor Oasis',
                        commonSpaces: 'Health Club, Great Hall (Gaming, Co-working), Private Club/Sound Stage, Cafe',
                        outdoorSpaces: 'Courtyard, Public Plaza, Roof Deck, Indoor/Outdoor Yoga, BBQ/Picnic',
                        availability: 'Currently Available'
                    },
                    {
                        propertyName: 'Corsair Apartments',
                        priceRange: '$2,337+',
                        specials: 'None explicitly stated',
                        poolType: 'Heated Courtyard Pool',
                        commonSpaces: 'Fitness Center (Peloton), Game Room, Library, Movie Room, Business Center, Package Concierge',
                        outdoorSpaces: 'Cabanas, Bocce Court, Fire Pit, Grilling Stations, Pizza Oven, Lawnside Movie Theater, Roof Deck',
                        availability: 'Varies, contact property'
                    }
                ],
                residentExperience: [
                    {
                        propertyName: '360 State Street',
                        management: 'Mixed; Maintenance praised, leasing office confused/obstructive. New management (South Oxford) criticized for degradation, poor communication, safety issues.',
                        noise: 'Significant concern; Street, train, thin walls. Loud music, sirens, train horns common.',
                        overallLiving: 'Prime location, nice community, but overpriced. Amenities degrading, common spaces limited hours.',
                        petIssues: 'Pet-friendly.'
                    },
                    {
                        propertyName: 'The Whit',
                        management: 'Mixed; Staff responsive/helpful, but inconsistent rule enforcement (pets). Some find management uncaring.',
                        noise: 'Major concern; LOUD downtown noise (bikes, stereos, drag racing), frequent train sounds. Unit-to-unit quiet.',
                        overallLiving: 'Modern, convenient, great location (near Yale). Drawbacks: parking, slow elevators. Can feel generic.',
                        petIssues: 'Pet-friendly, but poor rule enforcement (barking, pee, pool deck).'
                    },
                    {
                        propertyName: 'The Audubon',
                        management: 'Highly polarized; Praised as "super nice" by some, but others find them incompetent, unconcerned, not enforcing rules (noise, safety).',
                        noise: 'Major concern; Loud, inconsiderate neighbors ("frat house" vibe). Rules not enforced.',
                        overallLiving: 'Mixed; "Glorified dorm" or "nightmare" due to noise/management. Safety concerns (garage break-ins). Good location.',
                        petIssues: 'Pet-friendly.'
                    },
                    {
                        propertyName: 'The Anthem at Square 10',
                        management: 'Overwhelmingly positive; Staff helpful, patient, courteous, attentive.',
                        noise: 'No negative comments reported.',
                        overallLiving: 'Highly positive; "Full contentment," "dream manifested." Modern, walkable location, pet-friendly.',
                        petIssues: 'Pet-friendly.'
                    },
                    {
                        propertyName: 'Corsair Apartments',
                        management: 'Mixed; Many praise management and maintenance. Some report communication breakdowns, closing shared amenities for private events.',
                        noise: 'Mixed; Official rating 5/5, but others report "significant traffic noise from highway 91" that is "24/7" and disruptive. Frequent fire alarms.',
                        overallLiving: 'Positive; "At home," "old fashioned neighborhood" feel. Drawbacks: street parking, homeless population nearby, high utility costs, can feel like a dorm.',
                        petIssues: 'Dog-friendly.'
                    }
                ]
            };


            const ctx = document.getElementById('property-chart').getContext('2d');
            let propertyChart;

            const updateChart = (metric) => {
                propertyData.sort((a, b) => {
                    if (metric === 'value') {
                        return a.floorPlansPricing.range.split('-')[0].replace(/[^0-9.]/g, '') - b.floorPlansPricing.range.split('-')[0].replace(/[^0-9.]/g, '');
                    }
                    return b.scores[metric] - a.scores[metric];
                });

                const labels = propertyData.map(p => p.name);
                const data = propertyData.map(p => metric === 'value' ? p.floorPlansPricing.range.split('-')[0].replace(/[^0-9.]/g, '') : p.scores[metric]);

                let labelText = '';
                let backgroundColor = 'rgba(13, 148, 136, 0.6)'; /* Teal-600 */
                let borderColor = 'rgba(13, 148, 136, 1)';
                let hoverBackgroundColor = 'rgba(15, 118, 110, 1)'; /* Teal-700 */

                switch(metric) {
                    case 'value':
                        labelText = 'Starting Studio Price ($)';
                        backgroundColor = 'rgba(59, 130, 246, 0.6)'; // Blue
                        borderColor = 'rgba(59, 130, 246, 1)';
                        hoverBackgroundColor = 'rgba(37, 99, 235, 1)';
                        break;
                    case 'quiet':
                        labelText = 'Quiet Score (out of 5)';
                        backgroundColor = 'rgba(168, 85, 247, 0.6)'; // Purple
                        borderColor = 'rgba(168, 85, 247, 1)';
                        hoverBackgroundColor = 'rgba(147, 51, 234, 1)';
                        break;
                    case 'management':
                        labelText = 'Management Score (out of 5)';
                        backgroundColor = 'rgba(234, 179, 8, 0.6)'; // Yellow
                        borderColor = 'rgba(234, 179, 8, 1)';
                        hoverBackgroundColor = 'rgba(202, 138, 4, 1)';
                        break;
                    case 'amenities':
                        labelText = 'Amenity Score (out of 5)';
                        backgroundColor = 'rgba(239, 68, 68, 0.6)'; // Red
                        borderColor = 'rgba(239, 68, 68, 1)';
                        hoverBackgroundColor = 'rgba(220, 38, 38, 1)';
                        break;
                    default:
                        labelText = 'Overall Score (out of 5)';
                }

                if (propertyChart) {
                    propertyChart.destroy();
                }

                propertyChart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: labelText,
                            data: data,
                            backgroundColor: backgroundColor,
                            borderColor: borderColor,
                            borderWidth: 1,
                            hoverBackgroundColor: hoverBackgroundColor,
                            borderRadius: 4,
                        }]
                    },
                    options: {
                        indexAxis: 'y',
                        maintainAspectRatio: false,
                        responsive: true,
                        scales: {
                            x: {
                                beginAtZero: metric !== 'value',
                                grid: {
                                    drawOnChartArea: false
                                }
                            },
                             y: {
                                grid: {
                                    display: false
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        let label = context.dataset.label || '';
                                        if (label) {
                                            label += ': ';
                                        }
                                        if (context.parsed.x !== null) {
                                            if(metric === 'value') {
                                               label += new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', minimumFractionDigits: 0 }).format(context.parsed.x);
                                            } else {
                                               label += context.parsed.x;
                                            }
                                        }
                                        return label;
                                    }
                                }
                            }
                        },
                        onClick: (event, elements) => {
                            if (elements.length > 0) {
                                const chartElement = elements[0];
                                const propertyName = propertyChart.data.labels[chartElement.index];
                                const property = propertyData.find(p => p.name === propertyName);
                                if (property) {
                                    document.getElementById(property.id).scrollIntoView({ behavior: 'smooth' });
                                }
                            }
                        }
                    }
                });
            };

            const populateProfiles = () => {
                const container = document.getElementById('property-profiles-container');
                propertyData.forEach((p, index) => {
                    const amenityIcons = {
                        'pool': 'üèä', 'fitness': 'üí™', 'game': 'üéÆ', 'co-working': 'üíº', 'rooftop': 'üåá', 'concierge': 'üõéÔ∏è', 'yoga': 'üßò', 'golf': '‚õ≥', 'library': 'üìö', 'movie': 'üé¨', 'bocce': 'üé≥', 'pizza': 'üçï', 'sound': 'üéß', 'bike': 'üö≤', 'club': 'ü•Ç', 'plaza': 'üå≥'
                    };
                    const getIcon = (amenity) => {
                        const lowerAmenity = amenity.toLowerCase();
                        for (const key in amenityIcons) {
                            if (lowerAmenity.includes(key)) return amenityIcons[key];
                        }
                        return '‚≠ê';
                    };

                    const profileHTML = `
                        <article id="${p.id}" class="property-card p-8 scroll-mt-24" style="animation-delay: ${index * 0.1}s">
                           <div class="flex items-start justify-between mb-6">
                               <div>
                                   <h3 class="text-3xl font-bold gradient-text mb-2">${p.name}</h3>
                                   <div class="flex items-center space-x-4">
                                       <span class="bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm font-medium">
                                           Overall Score: ${p.scores.overall}/5
                                       </span>
                                       <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium">
                                           ${p.floorPlansPricing.range}
                                       </span>
                                   </div>
                               </div>
                               <div class="feature-icon">üè¢</div>
                           </div>

                           <div class="mb-8">
                                <h4 class="text-xl font-semibold mb-4 flex items-center">
                                    <span class="mr-2">üìñ</span> Overview
                                </h4>
                                <p class="text-gray-700 leading-relaxed">${p.overview}</p>
                           </div>

                           <div class="grid lg:grid-cols-2 gap-8 mb-8">
                                <div class="bg-gray-50 p-6 rounded-xl">
                                    <h4 class="text-xl font-semibold mb-4 flex items-center">
                                        <span class="mr-2">üí∞</span> Pricing & Plans
                                    </h4>
                                    <div class="space-y-3">
                                        <p class="text-gray-700"><strong>Price Range:</strong> <span class="text-purple-600 font-medium">${p.floorPlansPricing.range}</span></p>
                                        <p class="text-gray-700"><strong>Size:</strong> ${p.floorPlansPricing.sqFt}</p>
                                        <p class="text-gray-700"><strong>Special:</strong> <span class="text-amber-600 font-medium">${p.floorPlansPricing.special}</span></p>
                                        <p class="text-gray-700"><strong>Availability:</strong> <span class="text-green-600 font-medium">${p.floorPlansPricing.availability}</span></p>
                                    </div>
                                </div>
                                <div class="bg-gray-50 p-6 rounded-xl">
                                    <h4 class="text-xl font-semibold mb-4 flex items-center">
                                        <span class="mr-2">üéØ</span> Amenities
                                    </h4>
                                    <div class="grid grid-cols-2 gap-3">
                                        ${p.amenities.slice(0, 8).map(a => `<div class="flex items-center bg-white px-3 py-2 rounded-lg shadow-sm"><span class="mr-2">${getIcon(a)}</span><span class="text-sm">${a}</span></div>`).join('')}
                                    </div>
                                    ${p.amenities.length > 8 ? `<p class="text-sm text-gray-500 mt-3">+ ${p.amenities.length - 8} more amenities</p>` : ''}
                                </div>
                           </div>

                           <div class="mb-8">
                                <h4 class="text-xl font-semibold mb-4 flex items-center">
                                    <span class="mr-2">üè†</span> Resident Experience
                                </h4>
                                <div class="grid lg:grid-cols-2 gap-6">
                                    <div class="bg-green-50 p-6 rounded-xl">
                                        <h5 class="font-semibold text-green-800 mb-3 flex items-center">
                                            <span class="mr-2">‚úÖ</span> Pros
                                        </h5>
                                        <ul class="space-y-2">
                                            ${p.pros.slice(0, 4).map(pro => `<li class="text-sm text-green-700 flex items-start"><span class="mr-2 mt-1">‚Ä¢</span>${pro}</li>`).join('')}
                                        </ul>
                                    </div>
                                    <div class="bg-red-50 p-6 rounded-xl">
                                        <h5 class="font-semibold text-red-800 mb-3 flex items-center">
                                            <span class="mr-2">‚ö†Ô∏è</span> Cons
                                        </h5>
                                        <ul class="space-y-2">
                                            ${p.cons.slice(0, 4).map(con => `<li class="text-sm text-red-700 flex items-start"><span class="mr-2 mt-1">‚Ä¢</span>${con}</li>`).join('')}
                                        </ul>
                                    </div>
                                </div>
                           </div>

                           <div class="bg-blue-50 p-6 rounded-xl">
                                <h4 class="text-xl font-semibold mb-4 flex items-center">
                                    <span class="mr-2">üåü</span> Living Experience Summary
                                </h4>
                                <p class="text-gray-700 leading-relaxed">${p.overallLiving}</p>
                           </div>
                        </article>
                    `;
                    container.innerHTML += profileHTML;
                });
            };

            // Initialize the Modern UI framework
            ui.init();
        });
    </script>
</body>
</html>
